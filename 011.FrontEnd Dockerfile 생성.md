# Requirement

- FrontEnd(nuxt-project) Dockerfile 생성

## 해야 할 일

- **작성전 고려 사항**
  - 멀티스테이지 빌드
    - 빌드 스테이지에서 현재 애플리케이션이 사용중인 nodejs 버전을 이용하여 빌드하고, 런타임 스테이지에서는 최소한의 파일만 사용하여 이미지 크기를 최적화.

  - 보안 고려사항
    - non-root 사용자(nuxtjs)를 생성하여 보안을 강화.
    - Alpine Linux 기반 이미지를 사용하여 이미지 크기와 공격 표면 줄이기.

  - 최적화
    - 의존성을 먼저 복사하고 설치하여 Docker 레이어 캐싱을 활용.
    - 프로덕션에서는 개발 의존성을 제외하고 설치.
  
- `/nuxt-project` 폴더에 `Dockerfile`, `.dockerignore` 생성
- `Dockerfile` 생성시 아래 샘플 참고해서 `nuxt-project` 프로젝트에 맞게 수정

``` Dockerfile 샘플
# Build stage
FROM node:18-alpine AS builder

# 작업 디렉토리 설정
WORKDIR /app

# package.json과 package-lock.json 복사
COPY package*.json ./

# 의존성 설치
RUN npm ci --only=production=false

# 소스 코드 복사
COPY . .

# Nuxt 애플리케이션 빌드
RUN npm run build

# Production stage
FROM node:18-alpine AS runner

# 비root 사용자 생성
RUN addgroup --system --gid 1001 nodejs
RUN adduser --system --uid 1001 nuxtjs

# 작업 디렉토리 설정
WORKDIR /app

# 빌드된 애플리케이션과 필요한 파일들 복사
COPY --from=builder --chown=nuxtjs:nodejs /app/.output ./
COPY --from=builder --chown=nuxtjs:nodejs /app/package*.json ./

# 프로덕션 의존성만 설치
RUN npm ci --only=production && npm cache clean --force

# 비root 사용자로 전환
USER nuxtjs

# 포트 노출
EXPOSE 3000

# 환경 변수 설정
ENV NODE_ENV=production
ENV NITRO_PORT=3000
ENV NITRO_HOST=0.0.0.0

# 애플리케이션 실행
CMD ["node", "server/index.mjs"]

```
